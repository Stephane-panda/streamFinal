<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <title>In a memories</title>
    <script src="https://aframe.io/releases/1.1.0/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/donmccurdy/aframe-extras@v6.1.1/dist/aframe-extras.min.js"></script>
    <script src="https://unpkg.com/aframe-event-set-component@4.2.1/dist/aframe-event-set-component.min.js"></script>
    <script src="https://rawgit.com/fernandojsg/aframe-teleport-controls/master/dist/aframe-teleport-controls.min.js"></script>
    <script src="https://unpkg.com/aframe-particle-system-component@1.0.x/dist/aframe-particle-system-component.min.js"></script>
    <script src="https://recast-api.donmccurdy.com/aframe-inspector-plugin-recast.js"></script>
    <script src="bundle.js"></script>
  </head>
  <body>
    <a-scene
      stats
      ainspector-plugin-recast
      background="color: #000"
      fog="type: linear; color: #000; near: 30; far: 60"
    >
      <a-assets>
        <!-- <a-asset-item id="navmesh_spawn" src="assets/navmesh.gltf"></a-asset-item>
        <a-asset-item id="navmesh_elevator" src="assets/navmesh_elevator.gltf"></a-asset-item> -->
        <a-asset-item id="bedroom" src="assets/Bedroom2.gltf"></a-asset-item>
        <a-asset-item id="kitchen" src="assets/kitchen.obj"></a-asset-item>
        <a-asset-item id="jail" src="assets/jail.gltf"></a-asset-item>
        <a-asset-item id="book" src="assets/book.gltf"></a-asset-item>
        <a-asset-item
          id="ambiant"
          response-type="arraybuffer"
          src="assets/sound/ambiant.mp3"
          preload="auto"
        ></a-asset-item>
      </a-assets>

      <a-entity sound__ambiant="src: #ambiant ; autoplay: true"></a-entity>
      <a-entity asound-manager></a-entity>

      <a-entity
        id="level 1"
        position="-10 0 0"
      >
        <a-entity
          id="bedroom-background"
          gltf-model="#bedroom"
          scale="0.17 0.17 0.17"
          position="0 -0.5 1"
          adropzone="offset: -10 0.5 -1"
          hover-highlighter
        ></a-entity>
        <a-entity
          light="type: point; intensity: 0.3;"
          position="1.339 1.476 -3.470"
        ></a-entity>
        <a-entity
          id="book-entity"
          position="-1.650 0.564 -3.742"
          gltf-model="#book"
          scale="0.0012 0.0012 0.0012"
          rotation="-70 90 0 "
          grabbable="target : #right-hand"
          hover-highlighter
          disable-after-an-event=" delay: 100 ; component : grabbable; event : grabbed "
          event-set=" _delay: 100 ; object3D.position.y : 100; _event : grabbed "
        >
        </a-entity>
      </a-entity>

      <a-entity
        id="level 2"
        position="0 0 0"
      >
        <a-entity
          id="kitchen-background"
          obj-model="obj:#kitchen"
          material="side:double"
          scale="0.18 0.18 0.17"
          position="0 -0.7 0"
          rotation="0 -90 0 "
          hover-highlighter
        >
        </a-entity>

        <a-entity
          id="book-entity2"
          position="1.991 3.078 0.511"
          gltf-model="#book"
          scale="0.0012 0.0012 0.0012"
          rotation="-70 90 0 "
          grabbable="target : #right-hand"
          hover-highlighter
          disable-after-an-event=" delay: 100 ;  component : grabbable; event : grabbed "
          event-set=" _delay: 100 ; object3D.position.y : 100; _event : grabbed "
        >
        </a-entity>
      </a-entity>

      <a-entity
        id="level 3"
        position="10 0 0"
      >
        <a-entity
          id="jail-background"
          gltf-model="#jail"
          scale="0.47 0.47 0.47"
          position="0 -0.2 0"
          hover-highlighter
        ></a-entity>

        <a-entity
          light="type: point; intensity: 0.3;"
          position="-0.184 4.249 11.024"
        ></a-entity>
        <a-entity
          light="type: spot; intensity: 0.3;"
          position="-0.607 -1.001 -1.320"
        ></a-entity>

        <a-entity
          id="book-entity3"
          position="4.385 0.056 1.272"
          gltf-model="#book"
          scale="0.0012 0.0012 0.0012"
          rotation="-70 90 0 "
          grabbable="target : #right-hand"
          hover-highlighter
          disable-after-an-event=" delay: 100 ; component : grabbable; event : grabbed "
        >
        </a-entity>
      </a-entity>

      <a-entity
        id="book-entity0"
        position="0 1 -103"
        gltf-model="#book"
        scale="0.003 0.003 0.003"
        rotation="0 0 0 "
        grabbable="target : #right-hand"
        hover-highlighter
        disable-after-an-event=" delay: 100 ; component : grabbable; event : grabbed "
        event-set=" _delay: 500 ; object3D.position.y : 100; _event : grabbed "
      >
      </a-entity>
      <!-- <a-entity id="navmesh-manager" navmesh-manager="navmesh: #nav-mesh-spawn"
        event-set="_event: elevator; navmesh-manager.navmesh: #nav-mesh-elevator"
        listen-to="target: #btn-platform-1; event: click; emit: elevator"
        event-set__final="_event: final; navmesh-manager.navmesh: #nav-mesh-final"
        listen-to__final="target: #platform-1; event: animationcomplete; emit: final"
      > -->

      <!-- </a-entity> -->
      <!-- <a-entity nav-mesh id="nav-mesh-spawn" gltf-model="#navmesh_spawn" visible="false"></a-entity>
      <a-entity nav-mesh-disable position="0 0.2 0" id="nav-mesh-elevator" gltf-model="#navmesh_elevator" visible="false"></a-entity>
      <a-entity nav-mesh-disable position="0 11 0" id="nav-mesh-final" gltf-model="#navmesh_spawn" visible="false"></a-entity> -->

      <a-entity
        light="type: point; intensity: 0.3;"
        position="4 25 5"
      ></a-entity>

      <!-- <a-hexatile position="0 -1 0" size="5" cellsize="0.5" color="#216138"></a-hexatile>
      <a-hexatile position="0 10 0" size="5" cellsize="0.5" color="#216138"></a-hexatile> -->

      <!-- <a-entity position="0 0 -6.1">
        <a-hexatile id="platform-1" position="0 -1 0" size="3" cellsize="0.5" height="1" color="#216138"
          listen-to="target: #btn-platform-1; event: click; emit: up"
          animation="property: object3D.position.y; to: 10; dur: 5000; easing: linear; startEvents: up"
        ></a-hexatile>
        <a-hexatile id="btn-platform-1" hover-highlighter size="1" cellsize=".25" height="1" color="tomato"></a-hexatile>
      </a-entity> -->

      <a-entity
        id="rig"
        disable-in-vr="component: movement-controls"
        movement-controls="constrainToNavMesh: true;"
        position="0 0 -100 "
        listen-to__lv0="target: #book-entity0; event: grabbed; emit: go"
        event-set__lv0=" _delay : 500 ; _event: go; position : -10 0 1 ;"
        listen-to__lv1="target: #book-entity; event: grabbed; emit: grabbed"
        event-set__lv1="_event: grabbed; position : 13 0 4.5 ; _delay : 500"
        listen-to__lv2="target: #book-entity3; event: grabbed; emit: grabbed2"
        event-set__lv2="_event: grabbed2; position :  1 0 -1 ; _delay : 500"
        listen-to__lv3="target: #book-entity2; event: grabbed; emit: grabbed3"
        event-set__lv3="_event: grabbed3; position :  0 0 -100 ; _delay : 500"
        animation="delay : 1000 ; property: object3D.position.y; to: 10; dur: 5000; easing: linear; startEvents: up"
      >
        <a-entity
          id="head"
          position="0 1.7 0"
          camera
          look-controls="pointerLockEnabled: true"
        >
          <a-entity
            id="eyes"
            geometry="primitive: circle; radius: 0.0005"
            material="color: black"
            position="0 0 -0.1"
            cursor
            disable-in-vr="component: geometry"
            disable-in-vr__cursor="component: cursor"
            raycaster="objects: [hover-highlighter]; far: 1.5"
          ></a-entity>
        </a-entity>

        <a-entity
          id="hands"
          position="0 0.9 0"
          bind-rotation="target: #head"
          disable-in-vr="component: bind-rotation"
          disable-in-vr__pos="component: position"
        >
          <a-entity
            id="left-hand"
            position="-0.3 0 -0.3"
            rotation="0 0 90"
            bind-rotation="target: #head"
            disable-in-vr="component: bind-rotation"
            hand-controls="hand: left"
            teleport-controls="cameraRig: #rig; button: trigger; curveShootingSpeed: 8"
          ></a-entity>
          <a-entity
            id="right-hand"
            position="0.3 0 -0.3"
            rotation="0 0 -90"
            bind-rotation="target: #head"
            disable-in-vr="component: bind-rotation"
            hand-controls="hand: right"
            laser-controls="hand: right"
            raycaster="far: 2; objects: [hover-highlighter]; showLine: true"
            teleport-controls="cameraRig: #rig; button: trigger; curveShootingSpeed: 8"
          ></a-entity>
        </a-entity>
      </a-entity>
    </a-scene>

    <script></script>
  </body>
</html>
